# Multi-Source MFA ZTA Framework Environment Configuration
# Copy this file to compose/.env and update the values as needed

# Database Configuration
DB_DSN=postgresql://postgres:your_password@your_supabase_host:5432/postgres
PGOPTIONS=-c search_path=zta,public

# Elasticsearch Configuration
ELASTIC_VERSION=8.11.0
ELASTIC_PASSWORD=your_elastic_password
ELASTIC_PORT=9200
ES_HOST=http://elasticsearch:9200
ES_USER=elastic
ES_PASS=your_elastic_password
ES_API_KEY=your_api_key_if_using
ES_INDEX=cicids-events
ES_VALIDATED_INDEX=validated-signals
ES_MFA_INDEX=mfa-decisions

# Kibana Configuration
KIBANA_PORT=5601
KIBANA_SYSTEM_PASSWORD=your_kibana_password

# Trust Engine Thresholds
ALLOW_T=0.7
DENY_T=0.3
SIEM_HIGH_BUMP=0.25
SIEM_MED_BUMP=0.15
TRUST_BASE_GAIN=0.1
TRUST_FALLBACK_OBSERVED=0.5

# Geolocation & Distance
DIST_THRESHOLD_KM=500

# SIEM Severity Thresholds
SEV_HIGH=0.8
SEV_MED=0.5

# MFA Configuration
TOTP_SECRET=JBSWY3DPEHPK3PXP

# Simulation Configuration
SIM_MODE=enhanced
SIM_SLEEP=1.0
SIM_MAX_ROWS=200
SIM_MAX_PER_FILE=400
SIM_USE_GPS_FROM_WIFI=true
SIM_MIN_WIFI=0.9
SIM_MIN_GPS=0.85
SIM_MIN_TLS=0.7
SIM_MIN_DEVICE=0.85
SIM_PCT_SPOOFING=0.20
SIM_PCT_TLS_TAMPERING=0.15
SIM_PCT_DOS=0.20
SIM_PCT_EXFIL=0.15
SIM_PCT_EOP=0.15
SIM_PCT_REPUDIATION=0.15
SIM_INJECT_GPS_MISMATCH=true
SIM_TLS_BAD_RATE=0.3
SIM_PATCHED_TRUE_RATE=0.85
SIM_GPS_OFFSET_KM=600

# Service URLs (for external testing)
VALIDATE_URL=http://validation:8000/validate
GATEWAY_URL=http://gateway:8000/decision
BASELINE_URL=http://baseline:8000/decision
SIEM_URL=http://siem:8000
TRUST_URL=http://trust:8000
