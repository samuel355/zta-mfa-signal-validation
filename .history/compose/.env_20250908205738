# ---------- DB ----------
DB_DSN=postgresql+psycopg://postgres.ntaujhnmqblzieifvzor:MoneyInTheBank@aws-1-us-east-1.pooler.supabase.com:6543/postgres?sslmode=require

# ---------- Elasticsearch/Kibana (still used by gateway, safe even if you ignore it) ----------
ELASTIC_VERSION=8.12.2
ELASTIC_PASSWORD=GHana@20
KIBANA_SYSTEM_PASSWORD=GHana@20
ELASTIC_PORT=9200
KIBANA_PORT=5601
ES_HOST=http://elasticsearch:9200
ES_USER=elastic
ES_PASS=GHana@20
ES_MFA_INDEX=mfa-events
ES_INDEX=mfa-events*
ES_VALIDATED_INDEX=validated-context

# ---------- Risk / Severity ----------
ALLOW_T=0.25
DENY_T=0.75
SIEM_HIGH_BUMP=0.15
SIEM_MED_BUMP=0.07
SEV_MED=0.25
SEV_HIGH=0.75

# ---------- Validation ----------
DIST_THRESHOLD_KM=50
TLS_CRITICAL_TAGS=tor_suspect,malware_family_x,scanner_tool,cloud_proxy,old_openssl,insecure_client,honeypot_fingerprint

# ---------- Simulator (STRIDE-balanced â€” no tweaking) ----------
SIM_MODE=stride_balanced
SIM_SLEEP=0.8
SIM_MAX_ROWS=400
SIM_MAX_PER_FILE=600
SIM_BENIGN_KEEP=0.10
SIM_USE_GPS_FROM_WIFI=true

# internal mix (used by stride_balanced mode)
SIM_PCT_SPOOFING=0.20
SIM_PCT_TLS_TAMPERING=0.15
SIM_PCT_DOS=0.20
SIM_PCT_EXFIL=0.15
SIM_PCT_EOP=0.15
SIM_PCT_REPUDIATION=0.15

# floors so validated_context doesn't show "missing"
SIM_MIN_WIFI=0.90
SIM_MIN_GPS=0.85
SIM_MIN_TLS=0.70
SIM_MIN_DEVICE=0.85
SIM_GPS_OFFSET_KM=600

# ---------- Misc ----------
NETWORK_NAME=zta_net
PYPI_MIRROR=https://pypi.org/simple
TOTP_SECRET=JBSWY3DPEHPK3PXP

# ---- Opt bt recom ----
ES_API_KEY=
TRUST_BASE_GAIN=0.10            # small base risk from trust model
TRUST_FALLBACK_OBSERVED=0.1

# Simulator realism knobs (already used in code)
SIM_TLS_BAD_RATE=0.12
SIM_INJECT_GPS_MISMATCH=0.30
SIM_PATCHED_TRUE_RATE=0.75

# ---------- Postgres Fix ----------
PGOPTIONS=--extended-prepared-statements=off